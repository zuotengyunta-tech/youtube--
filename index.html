<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <title>ジョージ・メンズコーチ 動画一覧</title>
  <style>
    body { font-family: sans-serif; padding: 20px; }
    .video { margin-bottom: 20px; }
    .thumb { width: 240px; border-radius: 8px; }
  </style>
</head>
<body>
  <h1>ジョージ・メンズコーチ 動画一覧</h1>
  <div id="status">動画を読み込んでいます…</div>
  <div id="videos"></div>

  <script>
    const API_KEY = "AIzaSyAxk1YpQSe-qDtFUSUmnjnduanag41Mlyk";
    const CHANNEL_ID = "UCV9c2i-xw-zgsPGGs9LPu4g";

    async function getUploadsPlaylistId() {
      const url = `https://www.googleapis.com/youtube/v3/channels?part=contentDetails&id=${CHANNEL_ID}&key=${API_KEY}`;
      const res = await fetch(url);
      const data = await res.json();

      if (!data.items || data.items.length === 0) {
        throw new Error("Channel not found.");
      }

      return data.items[0].contentDetails.relatedPlaylists.uploads;
    }

    async function getVideosFromPlaylist(plId) {
      const url = `https://www.googleapis.com/youtube/v3/playlistItems?part=snippet&playlistId=${plId}&maxResults=50&key=${API_KEY}`;
      const res = await fetch(url);
      const data = await res.json();
      return data.items || [];
    }

    async function main() {
      try {
        const playlistId = await getUploadsPlaylistId();
        const videos = await getVideosFromPlaylist(playlistId);

        document.getElementById("status").innerText = `動画数：${videos.length}`;
        const container = document.getElementById("videos");

        videos.forEach(v => {
          const id = v.snippet.resourceId.videoId;
          const title = v.snippet.title;
          const thumb = v.snippet.thumbnails.medium.url;

          container.innerHTML += `
            <div class="video">
              <a href="https://www.youtube.com/watch?v=${id}" target="_blank">
                <img class="thumb" src="${thumb}">
              </a><br>
              <a href="https://www.youtube.com/watch?v=${id}" target="_blank">${title}</a>
            </div>
          `;
        });

      } catch (e) {
        console.error(e);
        document.getElementById("status").innerText = "動画の読み込みに失敗しました";
      }
    }

    main();
  </script>
</body>
</html>
