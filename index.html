<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <title>YouTube 最新動画取得</title>
</head>
<body>

<h2>最新動画一覧（Uploads）</h2>
<div id="video-list"></div>

<script>
  // ★ あなたが指定した API Key
  const apiKey = "AIzaSyAxk1YpQSe-qDtFUSUmnjnduanag41Mlyk";

  // ★ 正しい channelId（スクショから取得）
  const channelId = "UCGxzWLH1_1ABKKfSiy2WIAw";

  // 1. チャンネルの uploads プレイリストを取得
  async function getUploadsPlaylistId() {
    const url = `https://www.googleapis.com/youtube/v3/channels?part=contentDetails&id=${channelId}&key=${apiKey}`;

    const res = await fetch(url);
    const data = await res.json();

    if (!data.items || data.items.length === 0) {
      console.error("Channel not found or data missing", data);
      return null;
    }

    return data.items[0].contentDetails.relatedPlaylists.uploads;
  }

  // 2. uploads プレイリストから動画一覧を取得
  async function loadVideos() {
    const playlistId = await getUploadsPlaylistId();
    if (!playlistId) return;

    const url = `https://www.googleapis.com/youtube/v3/playlistItems?part=snippet&playlistId=${playlistId}&maxResults=20&key=${apiKey}`;

    const res = await fetch(url);
    const data = await res.json();

    const container = document.getElementById("video-list");
    container.innerHTML = "";

    data.items.forEach(item => {
      const videoId = item.snippet.resourceId.videoId;
      const title = item.snippet.title;
      const thumb = item.snippet.thumbnails.medium.url;

      container.innerHTML += `
        <div style="margin-bottom:20px">
          <img src="${thumb}" alt="${title}">
          <p>${title}</p>
          <a href="https://www.youtube.com/watch?v=${videoId}" target="_blank">視聴する</a>
        </div>
      `;
    });
  }

  loadVideos();
</script>

</body>
</html>
