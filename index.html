<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <title>YouTube å‹•ç”»ä¸€è¦§</title>
    <style>
        body { font-family: Arial; padding: 20px; background: #f7f7f7; }
        .video-card {
            background: white; padding: 10px; margin: 10px 0;
            border-radius: 8px; box-shadow: 0 2px 5px rgba(0,0,0,0.1);
            display: flex; align-items: center;
        }
        img { width: 180px; border-radius: 6px; margin-right: 15px; }
    </style>
</head>
<body>

<h2>ã‚¸ãƒ§ãƒ¼ã‚¸ãƒ»ãƒ¡ãƒ³ã‚ºã‚³ãƒ¼ãƒ å‹•ç”»ä¸€è¦§</h2>
<div id="video-list">èª­ã¿è¾¼ã¿ä¸­...</div>

<script>
const API_KEY = "AIzaSyAxk1YpQSe-qDtFUSUmnjnduanag41Mlyk";
const CHANNEL_ID = "UCGxzWLH1_1ABKKfSiy2WlAw";

// ğŸ”¥ 1. ãƒãƒ£ãƒ³ãƒãƒ«ã®ã€Œuploads ãƒ—ãƒ¬ã‚¤ãƒªã‚¹ãƒˆIDã€ã‚’å–å¾—
async function getUploadsPlaylistId() {
    const url = `https://www.googleapis.com/youtube/v3/channels?part=contentDetails&id=${CHANNEL_ID}&key=${API_KEY}`;
    const res = await fetch(url);
    const data = await res.json();
    return data.items[0].contentDetails.relatedPlaylists.uploads;
}

// ğŸ”¥ 2. ãƒ—ãƒ¬ã‚¤ãƒªã‚¹ãƒˆã®å‹•ç”»ã‚’ã™ã¹ã¦å–å¾—
async function getAllVideos(playlistId) {
    let videos = [];
    let pageToken = "";

    while (true) {
        let url =
            `https://www.googleapis.com/youtube/v3/playlistItems?` +
            `part=snippet&playlistId=${playlistId}&maxResults=50&key=${API_KEY}` +
            (pageToken ? `&pageToken=${pageToken}` : "");

        const res = await fetch(url);
        const data = await res.json();

        data.items.forEach(item => {
            const s = item.snippet;
            videos.push({
                title: s.title,
                videoId: s.resourceId.videoId,
                thumbnail: s.thumbnails.medium.url,
                published: s.publishedAt
            });
        });

        if (!data.nextPageToken) break;
        pageToken = data.nextPageToken;
    }

    return videos;
}

// ğŸ”¥ 3. HTML ã«å‹•ç”»ã‚’è¡¨ç¤º
function displayVideos(videos) {
    const list = document.getElementById("video-list");
    list.innerHTML = "";

    videos.forEach(v => {
        list.innerHTML += `
            <div class="video-card">
                <a href="https://www.youtube.com/watch?v=${v.videoId}" target="_blank">
                    <img src="${v.thumbnail}">
                </a>
                <div>
                    <h3>${v.title}</h3>
                    <p>${v.published}</p>
                    <a href="https://www.youtube.com/watch?v=${v.videoId}" target="_blank">
                        â–¶ å‹•ç”»ã‚’é–‹ã
                    </a>
                </div>
            </div>
        `;
    });
}

// ğŸ”¥ ãƒ¡ã‚¤ãƒ³å‡¦ç†
(async () => {
    const playlistId = await getUploadsPlaylistId();
    const videos = await getAllVideos(playlistId);
    displayVideos(videos);
})();
</script>

</body>
</html>
